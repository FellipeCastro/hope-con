<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <title>HOPE CONF 24</title>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- GOOGLE FONTS - OPEN SANS/CHERRY BOMB -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Knewave&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap"
            rel="stylesheet"
        />

        <!-- Bootstrap CSS -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <!--FONT AWESOME-->
        <script
            src="https://kit.fontawesome.com/108acab114.js"
            crossorigin="anonymous"
            defer
        ></script>

        <!--CSS SWIPER-->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
        />

        <!-- CSS -->
        <link rel="stylesheet" href="styles.css" />
    </head>

    <body>
        <!-- HEADER  -->
        <header class="header">
            <!-- botão Menu -->
            <button
                class="btn btn-primary btn-menu"
                type="button"
                data-bs-toggle="offcanvas"
                data-bs-target="#offcanvasScrolling"
                aria-controls="offcanvasScrolling"
            >
                <i class="fa-solid fa-bars"></i>
            </button>
            <!-- Canvas Menu -->
            <div
                class="offcanvas offcanvas-start"
                data-bs-scroll="true"
                data-bs-backdrop="false"
                tabindex="-1"
                id="offcanvasScrolling"
                aria-labelledby="offcanvasScrollingLabel"
            >
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasScrollingLabel">
                        Conferência Hope - 2024
                    </h5>
                    <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="offcanvas"
                        aria-label="Close"
                    ></button>
                </div>
                <div class="offcanvas-body">
                    <div class="navMobile">
                        <ul>
                           <li>  <i class="fa-solid fa-house"></i> <a href="#home">Home </a> </li>
                           <li> <i class="fa-solid fa-address-card"></i> <a href="#about">Sobre</a> </li>
                           <li> <i class="fa-solid fa-person"></i>><a href="#speakers"> Preletores</a> </li>
                           <li> <i class="fa-solid fa-check"></i><a href="#confirm-presence">Confirmar presença</a> </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- fim menu -->
            <img src="img/logo-hope.png" alt="Logo" class="logo" />

            <nav>
                <a href="#home">Home</a>
                <a href="#about">Sobre</a>
                <a href="#speakers">Preletores</a>
                <a href="#confirm-presence">Confirmar presença</a>
            </nav>
        </header>

        <!-- HOME -->
        <section class="home" id="home">
            <a href="#confirm-presence" class="btn-home"
                >Confirmar minha presença</a
            >
        </section>

        <!-- ABOUT -->
        <section class="about" id="about">
            <div class="text-container-about">
                <h2>Conferência Hope 2024</h2>
                <p>
                    Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Officia neque a praesentium, mollitia, aspernatur dolore
                    necessitatibus doloribus sequi libero ipsa porro enim,
                    deserunt doloremque ipsam placeat tenetur recusandae quasi.
                    Saepe. Lorem ipsum dolor, sit amet consectetur adipisicing
                    elit. Neque rerum quod et esse at iste, maxime similique
                    dolore, ullam consequatur quisquam. Fugiat sit omnis
                    pariatur eligendi aliquam deleniti totam labore? Lorem ipsum
                    dolor sit amet consectetur adipisicing elit. Aspernatur,
                    reprehenderit dolores. Pariatur, nisi, dicta eaque porro
                    quae, autem laudantium atque nam repellat sint velit tenetur
                    eveniet aliquid delectus officia doloremque.
                </p>
                <ul>
                    <li>
                        <i class="fa-solid fa-calendar-days"></i> 23 de Novembro
                    </li>
                    <li><i class="fa-solid fa-clock"></i> 15h / 19h</li>
                    <li>
                        <i class="fa-solid fa-location-dot"></i>
                        Rua das Amazonas, 210
                    </li>
                </ul>
            </div>

            <img src="img/img-about.svg" alt="Ilustração" class="img-about" />
        </section>

        <!-- SPEAKERS -->
        <section class="speakers" id="speakers">
            <div class="swiper">
                <h2>Preletores</h2>

                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <img src="img/paulo-pedro.png" alt="Paulo Pedro" />
                        <h3>Paulo Pedro</h3>
                        <p>
                            Lorem ipsum dolor sit amet consectetur, adipisicing
                            elit. Earum eum illum excepturi rem sed id dicta nam
                            atque, iusto, dolore quod enim similique impedit
                            nostrum temporibus ipsam praesentium molestiae!
                            Voluptatum?
                        </p>
                    </div>
                    <div class="swiper-slide">
                        <img src="img/thais-martins.png" alt="Thaís Martins" />
                        <h3>Thaís Martins</h3>
                        <p>
                            Lorem ipsum dolor sit amet consectetur, adipisicing
                            elit. Earum eum illum excepturi rem sed id dicta nam
                            atque, iusto, dolore quod enim similique impedit
                            nostrum temporibus ipsam praesentium molestiae!
                            Voluptatum?
                        </p>
                    </div>
                </div>
                <div class="swiper-pagination"></div>

                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
            </div>
        </section>

        <!-- CONFIRM PRESENCE -->
        <section class="confirm-presence" id="confirm-presence">
            <div class="confirm-presence-container">
                <div class="text-container-confirm-presence">
                    <h2>Confirme sua presença aqui!</h2>
                    <p>
                        Sua presença é muito importante para nós! Participe e
                        torne este momento ainda mais especial
                    </p>
                </div>
                <div class="form-container">
                    <form autocomplete="off" id="form">
                        <input
                            type="email"
                            name="email"
                            id="email"
                            placeholder="Digite seu e-mail"
                            required
                        />
                        <button type="submit" class="form-btn">
                            <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </form>
                    <p class="confirm-presence-msg" id="msg">
                        Presença confirmada!
                    </p>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="footer" id="footer">
            <img src="img/logo-hope.png" alt="Logo" class="logo" />

            <ul class="list-footer">
                <li>
                    <a
                        href="https://www.instagram.com/mac_kairos/"
                        target="_blank"
                        ><i class="fa-brands fa-instagram"></i> - mac_kairos</a
                    >
                </li>
                <li>
                    <a
                        href="https://www.facebook.com/ministerioaliancakairos"
                        target="_blank"
                        ><i class="fa-brands fa-facebook"></i> - Ministério
                        Aliança Cristã Kairós</a
                    >
                </li>
                <li>
                    <a href="#" target="_blank"
                        ><i class="fa-solid fa-phone"></i> - 00000-0000</a
                    >
                </li>
                <li>
                    <a href="#" target="_blank"
                        ><i class="fa-solid fa-envelope"></i> -
                        kairos@email.com</a
                    >
                </li>
                <li>
                    <a href="#" target="_blank"
                        ><i class="fa-solid fa-location-dot"></i> - Rua
                        Amazonas, Portal dos Ipês II</a
                    >
                </li>
            </ul>
        </footer>

        <!-- Bootstrap JavaScript Bundle (inclui Popper.js) -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            defer
        ></script>

        <!--JAVASCRIPT SWIPER-->
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
        <script src="script.js"></script>

        <!--FireBase Importação-->
        <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore.js"></script>
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
            import {
                getFirestore,
                collection,
                addDoc,
                query,
                where,
                getDocs,
                setDoc,
                doc,
            } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore.js";

            // Configuração do Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyCFWAKjdjxwWjzZe7sUDa3JI08d3NcRW7A",
                authDomain: "hope-con.firebaseapp.com",
                projectId: "hope-con",
                storageBucket: "hope-con.firebasestorage.app",
                messagingSenderId: "91630868574",
                appId: "1:91630868574:web:1650659cea72137fb33ccf",
                measurementId: "G-4LHZZV81YE",
            };

            // Inicializa o Firebase
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);

            // Função para contar documentos na coleção "email"
            async function contarEmails() {
                try {
                    const snapshot = await getDocs(collection(db, "email"));
                    return snapshot.size;
                } catch (error) {
                    console.error("Erro ao contar documentos:", error);
                    return null;
                }
            }

            // Função para atualizar a contagem na coleção "quantidade"
            async function atualizarContagem(quantidade) {
                try {
                    await setDoc(doc(db, "quantidade", "total"), {
                        quantidade: quantidade,
                    });
                    console.log("Contagem atualizada com sucesso:", quantidade);
                } catch (error) {
                    console.error("Erro ao atualizar a contagem:", error);
                }
            }

            // Evento de envio do formulário
            document
                .getElementById("form")
                .addEventListener("submit", async function (e) {
                    e.preventDefault();

                    const email = document.getElementById("email").value;
                    const msgElement = document.getElementById("msg");

                    try {
                        const q = query(
                            collection(db, "email"),
                            where("email", "==", email)
                        );
                        const querySnapshot = await getDocs(q);

                        if (querySnapshot.empty) {
                            console.log(
                                "E-mail não encontrado, adicionando ao Firestore..."
                            );

                            // Adiciona o e-mail à coleção "email"
                            await addDoc(collection(db, "email"), { email });

                            console.log("E-mail adicionado com sucesso!");

                            // Contar os e-mails e atualizar a coleção "quantidade"
                            const quantidade = await contarEmails();
                            if (quantidade !== null) {
                                await atualizarContagem(quantidade);
                            }

                            // Mensagem de sucesso
                            msgElement.textContent = "Presença confirmada!";
                            msgElement.style.color = "green";
                            msgElement.style.display = "block";
                            document.getElementById("email").value = "";
                        } else {
                            console.log("E-mail já cadastrado!");
                            msgElement.textContent =
                                "Este e-mail já está cadastrado!";
                            msgElement.style.color = "red";
                            msgElement.style.display = "block";
                        }

                        // Ocultar a mensagem após 3 segundos
                        setTimeout(() => {
                            msgElement.style.display = "none";
                        }, 3000);
                    } catch (error) {
                        console.error("Erro no envio do e-mail:", error);
                        msgElement.textContent =
                            "Erro ao salvar o e-mail, tente novamente.";
                        msgElement.style.color = "red";
                        msgElement.style.display = "block";
                    }
                });
        </script>
    </body>
</html>
